#!/usr/bin/env zsh

set -euo pipefail

: "${DOTFILES:=$HOME/dotfiles}"
out_file="$DOTFILES/zsh/git-aliases.zsh"

tmp_file="$(mktemp)"
trap 'rm -f "$tmp_file"' EXIT

{
    echo "# Generated by bin/generate-git-aliases. Do not edit manually."
    echo "# Regenerate after changing git aliases:"
    echo "#   bin/generate-git-aliases"
    for al in ${(f)"$(git --list-cmds=alias 2>/dev/null)"}; do
        printf "alias g%s='git %s'\n" "$al" "$al"
    done
} > "$tmp_file"

mv "$tmp_file" "$out_file"
echo "Wrote $out_file"
